@use "./sizes" as sizes;

.tgui-loader {
  display: block;
  aspect-ratio: 1;

  &--base {
    fill: transparent;
    stroke: #007AFF;
    stroke-linecap: round;
    overflow: visible;

    @each $size-type, $settings in (
      "sm": (
        "stroke-width": 2.5px,
        "strokes": (
          "0%": [#{1, 56}, 0],
          "50%": [#{43, 56}, -15],
          "100%": [#{43, 56}, -56],
        )
      ),
      "md": (
        "stroke-width": 3.5px,
        "strokes": (
          "0%": [#{1, 112}, 0],
          "50%": [#{89, 112}, -25],
          "100%": [#{89, 112}, -112],
        )
      ),
      "lg": (
        "stroke-width": 4px,
        "strokes": (
          "0%": [#{1, 138}, 0],
          "50%": [#{100, 138}, -40],
          "100%": [#{100, 138}, -138],
        )
      ),
    ) {
      &-#{$size-type} {
        width: sizes.size("base", $size-type);
        stroke-width: map-get($settings, "stroke-width");
        animation: tgui-loader-base-dash-#{$size-type} 2s ease infinite, tgui-loader-base-rotate 2s linear infinite;
      }

      @keyframes tgui-loader-base-dash-#{$size-type} {
        @each $percentage in ["0%", "50%", "100%"] {
          $stroke-settings: map-get(map-get($settings, "strokes"), $percentage);

          #{$percentage} {
            stroke: {
              dasharray: nth($stroke-settings, 1);
              dashoffset: nth($stroke-settings, 2);
            }
          }
        }
      }
    }
  }

  &--ios {
    display: flex;
    justify-content: center;
    align-items: center;

    @each $size-type, $_ in sizes.$sizes {
      &-#{$size-type} {
        width: sizes.size("ios", $size-type);
      }
    }
  }

  &__inner--ios {
    position: absolute;
    background-color: #707579;
    border-radius: 1000px;
    transform-origin: bottom;
    animation: tgui-loader-ios-fade 800ms linear infinite;
    opacity: .1;

    @each $size-type, $dimensions in (
      "sm": [2px, 5px],
      "md": [2.5px, 6.3px],
      "lg": [3.3px, 7.5px]
    ) {
      &-#{$size-type} {
        width: nth($dimensions, 1);
        height: nth($dimensions, 2);
      }
    }
  }
}

@keyframes tgui-loader-ios-fade {
  0% {
    opacity: 1
  }

  100% {
    opacity: .1
  }
}

@keyframes tgui-loader-base-rotate {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
